<div class="form-container">
  <mat-card class="form-card" appearance="outlined">
    <mat-card-header class="form-header">
      <mat-card-title class="title">Add car</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="addCarForm">
        <mat-form-field
          appearance="fill"
          class="form-field full-width"
          appearance="outline"
        >
          <mat-label>Id</mat-label>
          <input matInput type="text" formControlName="id" />
        </mat-form-field>

        <mat-form-field
          appearance="fill"
          class="form-field full-width"
          appearance="outline"
        >
          <mat-label>Manufacturer</mat-label>
          <mat-select formControlName="manufacturer">
            @for (m of manufacturers; track $index) {
            <mat-option value="{{ m }}">{{ m }}</mat-option>
            }
          </mat-select>
        </mat-form-field>

        <mat-form-field
          appearance="fill"
          class="form-field full-width"
          appearance="outline"
        >
          <mat-label>Model</mat-label>
          <input matInput type="text" formControlName="model" />
        </mat-form-field>

        <mat-form-field
          appearance="fill"
          class="form-field full-width"
          appearance="outline"
        >
          <mat-label>Price</mat-label>
          <input matInput type="number" formControlName="purchasePrice" />
        </mat-form-field>

        <mat-form-field
          appearance="fill"
          class="form-field full-width"
          appearance="outline"
        >
          <mat-label>Purchase date</mat-label>
          <input matInput type="date" formControlName="purchaseDateTime" />
        </mat-form-field>
        <mat-form-field
          appearance="fill"
          class="form-field full-width"
          appearance="outline"
        >
          <mat-label>Description</mat-label>
          <input matInput type="text" formControlName="description" />
        </mat-form-field>

        <div class="image-input-container">
          @if(selectedImage){
          <div class="fileName">
            <p>{{ selectedImage.name }}</p>
          </div>

          }
          <button
            mat-raised-button
            class="import-button"
            (click)="openFileDialog()"
          >
            Add picture
            <mat-icon>add</mat-icon>
          </button>
          <input
            type="file"
            #fileInput
            accept="image/*"
            (change)="onFileSelected($event)"
            hidden
          />
        </div>

        @if(conflict) {
        <p class="error">Car with given id already exists!</p>
        }

        <div class="button-container">
          <button
            mat-raised-button
            color="primary"
            (click)="addCar()"
            [disabled]="this.addCarForm.invalid || !this.selectedImage"
          >
            Add car
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
